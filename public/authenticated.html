<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="shortcut icon" type="image/png" href="images/favicon-32x32.png">
    <title>Playlist Saver</title>
</head>

<body>
    <div id="pageContainer">
        <header id='header'>
            <div id='flexContainer'>
                <a href="https://www.spotify.com/us/" target='_blank'><img id='spotifyLogo'
                        src='images\Spotify_Icon_RGB_White.png' alt="spotify logo" /></a>
                <h1 id='title'>Playlist Saver for Spotify</h1>
            </div>
        </header>
        <div id="contentContainer">
            <div class="container">
                <main id='main'>
                    <h2 id='loadingHeader'>Chatting with Spotify. This may take a few moments...</h2>
                    <p id='loadingParagraph'></p>
                    <a href="./playlist.txt" download id="download" hidden></a>
                </main>
            </div>
        </div>
        <footer id='footer'>
            <a href="https://www.spotify.com/us/" target='_blank'><img src='images\Spotify_Icon_RGB_White.png' alt="spotify logo" /></a>

            <a href="https://github.com/Whalem56" target="_blank"><img src="images\GitHub_Logo_White.png"
                    alt="github logo"></a>
            <a href="https://www.linkedin.com/in/will-richardson/" target="_blank"><img src="images\linkedin-3-512.png"
                    alt="linkedin logo"></a>
        </footer>
    </div>

    <script>
        window.onload = function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    console.log(this);
                    // Typical action to be performed when the document is ready:
                    document.querySelector("#loadingHeader").innerHTML =
                        'Enjoy your playlists!';
                    document.querySelector("#loadingParagraph").innerHTML = '(Whitespace will not show up in Notepad. To see formatting, use a different text editor.)';
                    document.querySelector('#download').click();
                } else if (this.readyState == 4 && this.status == 400) {
                    window.location.href = 'https://playlist-saver-web-app.herokuapp.com/';
                }
            };
            xhttp.open("GET", "https://playlist-saver-web-app.herokuapp.com/getPlaylists", true);
            xhttp.send();
        }
    </script>
</body>

</html>