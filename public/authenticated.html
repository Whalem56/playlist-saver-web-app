<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="shortcut icon" type="image/png" href="images/favicon-32x32.png">
    <title>Spotify Playlist Saver</title>
</head>

<body>
    <header id='header'>
        <div id='flexContainer'>
            <img id='logo' src='images\Spotify_Icon_RGB_White.png' alt="spotify logo" />
            <h1 id='title'>Spotify Playlist Saver</h1>
        </div>
    </header>
    <div class="container">
        <main id='main'>
            <h2 id='loading'>Chatting to Spotify. This may take a few seconds...</h2>
            <a href="./playlist.txt" download id="download" hidden></a>

        </main>
    </div>
    <footer id='footer'>
        <p>Check out my github!</p>
        <a href="https://www.spotify.com/us/" target="_blank">
            <img id='footerIcon' src="images\Spotify_Icon_RGB_White.png" alt="spotify logo">
        </a>
        <a href="https://www.spotify.com/us/" target="_blank">
            <img id='footerIcon' src="images\Spotify_Icon_RGB_White.png" alt="spotify logo">
        </a>
    </footer>

    <script>
        window.onload = function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    // Typical action to be performed when the document is ready:
                    document.querySelector("#loading").innerHTML =
                        'All done. Thanks for checking out my applications!';
                    // download('/public/playlist.txt');
                    document.querySelector('#download').click();
                }
            };
            xhttp.open("GET", "http://192.168.1.3:9000/getPlaylists", true);
            xhttp.send();

            // function download(filename) {
            //     var element = document.createElement('a');
            //     //element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
            //     element.setAttribute('href', filename);
            //     //element.setAttribute('download', ''filename'');

            //     element.style.display = 'none';
            //     document.body.appendChild(element);

            //     element.click();

            //     document.body.removeChild(element);
            // }
        }
    </script>
</body>

</html>